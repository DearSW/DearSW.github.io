<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  
  <title>新世界 Express4与Angular5 | 后来他乡遇故人</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="新世界," />
  

  <meta name="description" content="开始 Angular目前动态 Angular1 继续维护中 Angular2 稳定版本，不兼容Ng1 Angular4 稳定版本，兼容Ng2，不兼容Ng1 Angular5 最新版本，向后兼容   Express目前动态 Express3 Express4，这个版本是对 Express 3 的一个颠覆性改变。   我们使用的是Express4和Angular5。 构建程序  npm install">
<meta name="keywords" content="新世界">
<meta property="og:type" content="article">
<meta property="og:title" content="新世界 Express4与Angular5">
<meta property="og:url" content="http://yoursite.com/2017/12/16/新世界-Express4与Angular4/index.html">
<meta property="og:site_name" content="后来他乡遇故人">
<meta property="og:description" content="开始 Angular目前动态 Angular1 继续维护中 Angular2 稳定版本，不兼容Ng1 Angular4 稳定版本，兼容Ng2，不兼容Ng1 Angular5 最新版本，向后兼容   Express目前动态 Express3 Express4，这个版本是对 Express 3 的一个颠覆性改变。   我们使用的是Express4和Angular5。 构建程序  npm install">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2017/12/16/新世界-Express4与Angular4/新世界-Express4与Angular4/hexo1.png">
<meta property="og:image" content="http://yoursite.com/2017/12/16/新世界-Express4与Angular4/hexo1.png">
<meta property="og:image" content="http://yoursite.com/2017/12/16/新世界-Express4与Angular4/新世界-Express4与Angular4/hexo2.png">
<meta property="og:image" content="http://yoursite.com/2017/12/16/新世界-Express4与Angular4/hexo2.png">
<meta property="og:image" content="http://yoursite.com/2017/12/16/新世界-Express4与Angular4/新世界-Express4与Angular4/hexo3.png">
<meta property="og:image" content="http://yoursite.com/2017/12/16/新世界-Express4与Angular4/hexo3.png">
<meta property="og:image" content="http://yoursite.com/2017/12/16/新世界-Express4与Angular4/新世界-Express4与Angular4/hexo4.png">
<meta property="og:image" content="http://yoursite.com/2017/12/16/新世界-Express4与Angular4/hexo4.png">
<meta property="og:image" content="http://yoursite.com/2017/12/16/新世界-Express4与Angular4/新世界-Express4与Angular4/hexo5.png">
<meta property="og:image" content="http://yoursite.com/2017/12/16/新世界-Express4与Angular4/hexo5.png">
<meta property="og:updated_time" content="2017-12-21T15:12:51.819Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="新世界 Express4与Angular5">
<meta name="twitter:description" content="开始 Angular目前动态 Angular1 继续维护中 Angular2 稳定版本，不兼容Ng1 Angular4 稳定版本，兼容Ng2，不兼容Ng1 Angular5 最新版本，向后兼容   Express目前动态 Express3 Express4，这个版本是对 Express 3 的一个颠覆性改变。   我们使用的是Express4和Angular5。 构建程序  npm install">
<meta name="twitter:image" content="http://yoursite.com/2017/12/16/新世界-Express4与Angular4/新世界-Express4与Angular4/hexo1.png">

  

  
    <link rel="icon" href="/logo3.png">
  

  
  <link href="/css/styles.css?v=c114cbe6" rel="stylesheet">


  <style type="text/css">
  
      /**
       * index home
       */

      .content-home {
          position: absolute;
          top: 50%;
          width: 100%;
          height: 100%;
          height: 300px;
          margin-top: -150px;
          margin-bottom: 100px;
          right: 400px;
          opacity: 0;
      }

      .content-home .nav .item a:hover {
          color: #9E9E9E;
      }


  </style>

  <!-- 
    <link rel="stylesheet" href="/css/personal-style.css">
   -->

  <!-- 

  

  
 -->


  <!-- 
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
   -->
</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">目录</span>
  

  <div class="post-header CENTER">
   

  <div class="toolbox">
    <a class="toolbox-entry" href="/archives">
      <span class="toolbox-entry-text">目录</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            文章
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/category/"
            rel="noopener noreferrer"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/search/"
            rel="noopener noreferrer"
            target="_self"
            >
            搜索
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#开始"><span class="toc-text">开始</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Angular5"><span class="toc-text">Angular5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#长期更新中，谢谢。"><span class="toc-text">长期更新中，谢谢。</span></a></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-新世界-Express4与Angular4" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">新世界 Express4与Angular5</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2017.12.16</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>Shaowei_Teng</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/新世界/">新世界</a>
  </span>



      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      

      
      
    </div>
  </header>

  <div class="article-content">
    
      <h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><ol>
<li>Angular目前动态<ol>
<li>Angular1 继续维护中</li>
<li>Angular2 稳定版本，不兼容Ng1</li>
<li>Angular4 稳定版本，兼容Ng2，不兼容Ng1</li>
<li>Angular5 最新版本，向后兼容</li>
</ol>
</li>
<li>Express目前动态<ol>
<li>Express3</li>
<li>Express4，这个版本是对 Express 3 的一个颠覆性改变。</li>
</ol>
</li>
<li><strong>我们使用的是Express4和Angular5。</strong></li>
<li><p>构建程序</p>
<ol>
<li><strong>npm install express-generator -g</strong> 全局安装Express4生成器，用来快速生成Express4程序。</li>
<li><strong>express expressng</strong> 生成名为<code>expressng</code>的Express4程序。</li>
<li><strong>cd expressng</strong> 切换到expressng目录下</li>
<li><strong>npm install</strong> 安装NPM包</li>
<li><strong>cat package.json</strong> 查看package.json文件</li>
<li>发现少一些依赖包，添加依赖<ol>
<li><strong>npm install express-session ejs path -S</strong></li>
</ol>
</li>
<li><strong>npm install -g @angular/cli@latest</strong> 全局安装Angular5命令行，方便构建Angular5程序，此处的安装命令有时容易安装失败，多尝试。</li>
<li><strong>cd public</strong> 切换到Express4程序的public目录中，之后先删除public目录下的所有文件。</li>
<li><strong>ng new esng</strong> 在public目录中创建Angular5程序，命名为<code>esng</code>。</li>
<li><strong>cd esng</strong> 切换到esng目录下。</li>
<li><strong>npm run start或者ng serve</strong> 启动Angular5程序。</li>
<li><strong>cd ..</strong></li>
<li><strong>cd ..</strong> 此时切换到expressng目录下</li>
<li><strong>npm run start</strong> 启动Express程序。</li>
<li>此时这两个程序均已启动了，但是貌似却都没有关联起来，因为Express4程序中并没有看见Angular5程序的界面，那么我们需要怎么做呢？</li>
<li><strong>cd public/esng</strong> 首先切换到esng目录下。</li>
<li><strong>npm run build或者ng build</strong> 此时，我们打包Angular5程序，接在会在当前目录下生成dist目录。</li>
<li>然后，我们更改Express4程序的<code>app.js</code>文件中的静态资源管理目录，之前是<code>public</code>目录，现在改为映射到<code>public/esng/dist</code>目录。</li>
<li>接着，我们再更改Express4程序view目录下的index.ejs文件，如何更改？直接复制Angular5程序下dist目录中的index.html文件。</li>
<li>其中的原由，慢慢想一想就恍然大悟了。</li>
<li><p>参考例图</p>
<p><img src="./新世界-Express4与Angular4/hexo1.png" alt="图例"></p>
<img src="/2017/12/16/新世界-Express4与Angular4/hexo1.png">
</li>
</ol>
</li>
</ol>
<h2 id="Angular5"><a href="#Angular5" class="headerlink" title="Angular5"></a>Angular5</h2><ol>
<li>上面Express和Angular的结合已经完成。</li>
<li><p><strong>angular-cli的升级记录</strong></p>
<ol>
<li>查看当前版本 <strong>ng version</strong></li>
<li>首先 <strong>npm uninstall -g @angular/cli</strong> </li>
<li>接着 <strong>npm cache verify</strong></li>
<li>最后 <strong>npm install -g @angualr/cli@latest</strong></li>
<li>验证版本 <strong>ng version</strong></li>
<li>如图<br><img src="./新世界-Express4与Angular4/hexo2.png" alt="图例"><img src="/2017/12/16/新世界-Express4与Angular4/hexo2.png">
</li>
</ol>
</li>
<li><p>模块</p>
<ol>
<li><strong>app.module.ts</strong> 根模块<ol>
<li><strong>declarations</strong> 自定义组件声明</li>
<li><strong>imports</strong> 第三方辅助组件声明或者子模块、路由模块</li>
<li><strong>providers</strong> 服务组件声明</li>
<li><strong>boostrap</strong> 启动组件声明</li>
</ol>
</li>
<li>路由模块</li>
<li>子模块</li>
</ol>
</li>
<li><p>组件</p>
<ol>
<li><strong>app.component.ts</strong> 根组件 </li>
<li><strong>ng g componet 组件名</strong> 生成一个组件，由于没有指定路径，这个组件式默认放在 <code>src/app</code> 目录下的。当然你可以指定特定的目录。记得把组件在模块中声明！<ol>
<li>一般，这个生成的组件目录下有四个文件 <ol>
<li>组件名.component.ts</li>
<li>组件名.component.html</li>
<li>组件名.component.css</li>
<li>组件名.component.spec.ts</li>
</ol>
</li>
<li>先来谈谈 <strong>组件名.component.ts</strong><ol>
<li><img src="./新世界-Express4与Angular4/hexo3.png" alt="图例">    <img src="/2017/12/16/新世界-Express4与Angular4/hexo3.png"></li>
<li>你需要从Angular的核心库中导入 <code>component</code> ，同时使用 <code>@component</code> 装饰器函数来注解这个组件。</li>
<li><strong>selector</strong> 组件的CSS选择器</li>
<li><strong>templateUrl</strong> 组件模板文件的URL路径</li>
<li><strong>styleUrls</strong> 组件私有的CSS文件URL路径</li>
<li><strong>constructor</strong> 构造器函数，类似于Java的类的构造器，但这并不是Angular所特有的。我们一般只在constructor中进行依赖注入，其中初始化的工作就不要在其中做。<br><img src="./新世界-Express4与Angular4/hexo4.png" alt="图例"><img src="/2017/12/16/新世界-Express4与Angular4/hexo4.png"></li>
<li><strong>ngOnInit</strong> 初始化函数，Angular的生命周期钩子，我们应该在其中做初始化操作。比如上图的<code>this.data=&#39;疼杂味&#39;</code>就应该放在NgOnInit中来做。</li>
<li><strong>export</strong> 一定不要忘记使用export把组件导出，以方便在任何地方使用import导入。</li>
<li><strong>implements</strong> 类语言的特质，用来实现某个接口，这里是实现OnInit接口。</li>
</ol>
</li>
<li>再谈谈 组件名.component.html<ol>
<li>这个是组件的HTML模板。这里面涉及到的一般是数据绑定、管道过滤器、事件绑定等等。</li>
<li><strong></strong> 单向数据绑定</li>
<li><strong>[(ngModel)]</strong> 双向数据绑定<ol>
<li>注意，在使用双向数据绑定时，必须需要先导入FormsModule模块，在<code>app.module.ts</code>根模块中导入。</li>
<li><code>import { FormsModule } from &#39;@angular/forms&#39;;</code></li>
</ol>
</li>
<li><strong>*ngFor</strong> 循环指令，<code>&lt;li *ngFor=&quot;let hero of heroes&quot;&gt;</code></li>
<li><strong>(event)=”fn”</strong> 事件绑定，<code>&lt;li *ngFor=&quot;let hero of heroes&quot; (click)=&quot;onSelect(hero)&quot;&gt;</code></li>
<li><strong>*ngIf</strong> 条件判断，<code>&lt;div *ngIf=&quot;selectedHero&quot;&gt;</code></li>
<li><strong>[class.some-css-class]=”some-condition”</strong> 动态样式绑定，根据条件来判断是否使用这个样式。</li>
</ol>
</li>
</ol>
</li>
<li>子组件<ol>
<li>说到子组件，一般就是父子组件之间的通信（数据传递）。</li>
<li>抽离父组件某些共性、通用的部分作为子组件，以便来复用。</li>
<li>父组件向子组件传递数据<ol>
<li><strong>@input</strong> @input用在子组件中，注解需要用来接收父组件的变量，<code>@Input() temp: any;</code>，这里的temp是任意类型的，用来接收父组件传递过来的东西。</li>
<li>在子组件的ts文件中，引入input，<code>import { Component, OnInit, Input } from &#39;@angular/core&#39;;</code></li>
<li>比如父组件名为parent-component，子组件叫child-component，在父组件的HTML中需要这样写 <code>&lt;child-component [temp]=&quot;666&quot;&gt;&lt;/child-component&gt;</code>，那么这个666就是从父组件中传递过来的，通过单向数据绑定的方式。</li>
<li></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>服务<ol>
<li>定位：组件不应该直接获取或者保存数据，这一切应该交给服务去做。</li>
<li><strong>ng g service &lt;服务名&gt;</strong> 创建一个服务文件 <code>&lt;服务名&gt;.service.ts</code>，如果没有指定特定目录，这个文件默认放在 <code>src/app</code> 目录下，文件内容如下<br><img src="./新世界-Express4与Angular4/hexo5.png" alt="图例"><img src="/2017/12/16/新世界-Express4与Angular4/hexo5.png"></li>
<li><strong>@Injectable</strong> 注解这个服务的装饰器函数。</li>
<li>服务创建之后，还需要声明这个服务，就像声明组件一样。可以在当前组件中声明，可以在根组件中声明，可以在根模块中声明，任选其一即可。但是一般流行的做法是放在根模块中，那么可以使用 <code>ng g service &lt;服务名&gt; --module=app</code>，这会自动在根模块中声明，不用手动操作了。</li>
<li>最后，在需要使用服务的组件的ts中constructor中注入服务，<code>constructor(private heroService: HeroService) {}</code></li>
<li>在服务器中获取数据，那么我们就要使用到HTTP请求了，下面谈谈Angular的HTTP。<ol>
<li><strong>@angular/http与@angular/common/http</strong> 在Angular5的官方建议中，希望@angular/http将被@angular/common/http全面替代。</li>
<li>在根组件中引入HttpClientModule，<code>import { HttpClientModule }    from &#39;@angular/common/http&#39;;</code>，并在imports中声明。</li>
<li>在service文件中引入HttpClient、HTTPHeaders，<code>import { HttpClient, HttpHeaders } from &#39;@angular/common/http&#39;;</code>，并在构造器函数中注入，<code>constructor(private http: HttpClient){}</code>。</li>
</ol>
</li>
</ol>
</li>
</ol>
<h2 id="长期更新中，谢谢。"><a href="#长期更新中，谢谢。" class="headerlink" title="长期更新中，谢谢。"></a>长期更新中，谢谢。</h2>
    
  </div>
</article>


   

   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2017/12/15/新世界-前端服务器环境搭建记录/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2017/12/20/新世界-GATSBY，基于React的静态网站生成框架/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              文章
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/category/"
              rel="noopener noreferrer"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              关于
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              rel="noopener noreferrer"
              target="_self"
              >
              搜索
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    

    




    

    
	
  </div>

  

  <script type="text/javascript">

  function loadScript(url, callback) {
      var script = document.createElement('script')
      script.type = 'text/javascript';

      if (script.readyState) { //IE
        script.onreadystatechange = function() {
          if (script.readyState == 'loaded' ||
            script.readyState == 'complete') {
            script.onreadystatechange = null;
            callback();
          }
        };
      } else { //Others
        script.onload = function() {
          callback();
        };
      }

      script.src = url;
      document.getElementsByTagName('head')[0].appendChild(script);
  }

  function indexHomeAnimation() {

       var target = document.querySelector('.content-home');
       if( target != null ) {
          target.style.transition = "all 2s cubic-bezier(0.57, 0.05, 0.36, 1)";
          target.style.right = 0;
          target.style.opacity = 1.0;
       } else {
          return;
       }
       
  }


  function downloadJS(url) {

      var elem = document.createElement("script");
      elem.src = url;
      document.body.appendChild(elem);
  }

  function downloadCSS(url) {

      var elem = document.createElement("link");
      elem.rel = "stylesheet";
      elem.type = "text/css";
      elem.href = url;
      document.body.appendChild(elem);

  }

  function downloadComponets() {

    downloadCSS("/css/personal-style.css");
    downloadJS("https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js");
    downloadCSS("//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css");

  }



  window.onload = function() {

    indexHomeAnimation();
    downloadComponets();
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>


</body>
</html>
